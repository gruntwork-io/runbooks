# Git Workspace Feature Demo

> **The Paradigm Shift**: This runbook demonstrates a new way of working with code. Instead of needing to be an expert to make changes, you follow a guided workflow that encodes expert knowledge. You get real files, real Git history, and a real PRâ€”but with structured guardrails.

This demo walks through the complete Git Workspace workflow:
1. Authenticate with GitHub
2. Clone a repository
3. Make guided changes using inputs and templates
4. Review all changes with the diff viewer
5. Create a pull request with one click

---

## Step 1: Connect to GitHub

<Admonition type="info" title="Authentication Methods">
You can authenticate using:
- **Personal Access Token (PAT)**: Paste a token from GitHub Settings â†’ Developer Settings â†’ Personal Access Tokens
- **Device Flow**: Click to open GitHub in a new tab, enter a code, and authorize
- **Environment Variable**: If `GITHUB_TOKEN` or `GH_TOKEN` is set, it will be used automatically
</Admonition>

<GitHubAuth 
  id="github" 
  title="Connect to GitHub"
  description="We need GitHub access to clone repositories and create pull requests on your behalf."
/>

---

## Step 2: Clone a Repository

Once authenticated, select a repository to clone. You can:
- **Search** through your repositories
- **Select a branch** to work from
- The files will appear in the **Git Workspace** tab on the right panel

<GitClone 
  id="repo"
  githubAuthId="github"
  title="Clone Repository"
  description="Select a repository and branch to clone. The repository files will be available for modification."
/>

<Admonition type="note" title="Check the Git Workspace Tab">
After cloning, click the **Git Workspace** tab on the right to browse the repository files. You'll see the full file tree just like in your local IDE.
</Admonition>

---

## Step 3: Configure Your Changes

Now let's define what changes we want to make. Fill out the form belowâ€”these values will be used to generate configuration files.

<Inputs id="config">
```yaml
variables:
  - name: project_name
    type: string
    description: Name of the project (used in file paths and configuration)
    default: my-project
    
  - name: environment
    type: enum
    description: Target environment for this configuration
    options:
      - dev
      - staging
      - prod
    default: dev
    
  - name: owner_email
    type: string
    description: Email address of the project owner
    default: team@example.com
    
  - name: enable_monitoring
    type: bool
    description: Enable monitoring and alerting
    default: true
```
</Inputs>

---

## Step 4: Generate Configuration Files

Based on your inputs, we'll generate standardized configuration files. This is where the **expert knowledge is encoded**â€”the templates ensure consistent, best-practice configurations.

### 4.1 Application Settings

<TemplateInline inputsId="config" workspaceId="repo" outputPath="config/{{ .project_name }}/settings.json">
```json
{
  "project": {
    "name": "{{ .project_name }}",
    "environment": "{{ .environment }}",
    "owner": "{{ .owner_email }}"
  },
  "features": {
    "monitoring": {{ .enable_monitoring }},
    "logging": true,
    "metrics": {{ .enable_monitoring }}
  },
  "metadata": {
    "generated_by": "runbook",
    "version": "1.0.0"
  }
}
```
</TemplateInline>

### 4.2 Environment Variables Template

<TemplateInline inputsId="config" workspaceId="repo" outputPath="config/{{ .project_name }}/.env.{{ .environment }}">
```
# Environment configuration for {{ .project_name }}
# Environment: {{ .environment }}
# Owner: {{ .owner_email }}

PROJECT_NAME={{ .project_name }}
ENVIRONMENT={{ .environment }}
LOG_LEVEL={{ if eq .environment "prod" }}warn{{ else }}debug{{ end }}
MONITORING_ENABLED={{ .enable_monitoring }}
```
</TemplateInline>

### 4.3 README for the Configuration

<TemplateInline inputsId="config" workspaceId="repo" outputPath="config/{{ .project_name }}/README.md">
```markdown
# {{ .project_name }} Configuration

This configuration was generated by a Runbook.

## Environment: {{ .environment }}

- **Owner**: {{ .owner_email }}
- **Monitoring**: {{ if .enable_monitoring }}Enabled{{ else }}Disabled{{ end }}

## Files

- `settings.json` - Main application settings
- `.env.{{ .environment }}` - Environment variables

## Usage

Copy `.env.{{ .environment }}` to `.env` and adjust values as needed.
```
</TemplateInline>

<Admonition type="info" title="Review Your Changes">
The generated files are now in the workspace. Check the **Git Workspace** tab to see:
- ğŸ“„ The new files created
- ğŸŸ¢ Green indicators showing added files
- Click **any file** to see its contents
</Admonition>

---

## Step 5: Review Changes and Create Pull Request

Before creating a PR, review exactly what will be committed. Click **"Review Changes"** to see a unified diff of all modifications.

<GitHubPullRequest
  id="pr"
  gitCloneId="repo"
  githubAuthId="github"
  title="Create Pull Request"
  description="Review your changes, then create a branch and open a PRâ€”all in one step."
  defaultBranchName="runbook/{{ .project_name }}-{{ .environment }}-config"
  defaultCommitMessage="Add {{ .project_name }} configuration for {{ .environment }} environment"
  defaultPrTitle="[Runbook] Add {{ .project_name }} configuration ({{ .environment }})"
  defaultPrBody="## Summary

This PR adds configuration files for the **{{ .project_name }}** project in the **{{ .environment }}** environment.

## Changes

- Added `config/{{ .project_name }}/settings.json` - Application settings
- Added `config/{{ .project_name }}/.env.{{ .environment }}` - Environment variables
- Added `config/{{ .project_name }}/README.md` - Documentation

## Configuration Details

- **Owner**: {{ .owner_email }}
- **Monitoring**: {{ if .enable_monitoring }}Enabled{{ else }}Disabled{{ end }}

---

*Generated by [Runbooks](https://github.com/gruntwork-io/runbooks)*"
  draft={false}
/>

---

## How This Feature Works

### The Three New Blocks

| Block | Purpose |
|-------|---------|
| `<GitHubAuth>` | Handles GitHub authentication (PAT, device flow, or env var) |
| `<GitClone>` | Clones a repository to a local workspace |
| `<GitHubPullRequest>` | Creates branch, commits, pushes, and opens a PR |

### The Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GitHubAuth â”‚â”€â”€â”€â–¶â”‚  GitClone   â”‚â”€â”€â”€â–¶â”‚  Templates  â”‚â”€â”€â”€â–¶â”‚ GitHubPR    â”‚
â”‚  (auth)     â”‚    â”‚  (clone)    â”‚    â”‚  (modify)   â”‚    â”‚ (commit+PR) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Key Features

1. **Real Files, Real Git**: You're working with actual repository contents, not abstractions
2. **Transparent Changes**: The diff viewer shows exactly what will be committed
3. **Template Variables**: Branch names, commit messages, and PR descriptions can use input values
4. **Guided Experience**: The runbook teaches as it guidesâ€”you understand what's happening

### The Paradigm Shift

This represents a new way of contributing to codebases:

| Traditional Approach | Runbooks Approach |
|---------------------|-------------------|
| Expert does the work | Expert encodes the knowledge |
| User waits and hopes | User learns and acts |
| Knowledge silos | Knowledge scales |
| "Ask Sarah, she knows" | "Run the runbook" |

---

## Try It Yourself

1. âœ… Authenticate with GitHub above
2. âœ… Clone one of your test repositories
3. âœ… Fill in the configuration values
4. âœ… Review the generated files in the Git Workspace tab
5. âœ… Click "Review Changes" to see the diff
6. âœ… Create a pull request!
