# Test configuration for demo3
# Generated by: runbooks test init
# Edit this file to customize your tests.

version: 1

settings:
  # Generate files to a temp directory (cleaned up after test)
  use_temp_working_dir: true
  # Test timeout
  timeout: 5m
  # Can this runbook's tests run in parallel with others?
  parallelizable: true

tests:
  - name: happy-path
    description: Standard successful execution

    inputs:
      # AWSAccounts: map
      test1.AWSAccounts:
        fuzz:
          type: map
          minCount: 2
          maxCount: 4
          schema:
            - email
            - environment
            - id
      # OrgNamePrefix: 
      test1.OrgNamePrefix:
        fuzz:
          type: string
          minLength: 5
          maxLength: 20
      # DefaultRegion: enum [us-east-1, us-east-2, us-west-1, us-west-2, af-south-1, ap-east-1, ap-east-2, ap-south-1, ap-south-2, ap-southeast-1, ap-southeast-2, ap-southeast-3, ap-southeast-4, ap-southeast-5, ap-southeast-7, ap-northeast-1, ap-northeast-2, ap-northeast-3, ca-central-1, ca-west-1, eu-central-1, eu-central-2, eu-west-1, eu-west-2, eu-west-3, eu-south-1, eu-south-2, eu-north-1, il-central-1, mx-central-1, me-south-1, me-central-1, sa-east-1, us-gov-east-1, us-gov-west-1, cn-north-1, cn-northwest-1]
      test1.DefaultRegion:
        fuzz:
          type: enum
          options: ["us-east-1", "us-east-2", "us-west-1", "us-west-2", "af-south-1", "ap-east-1", "ap-east-2", "ap-south-1", "ap-south-2", "ap-southeast-1", "ap-southeast-2", "ap-southeast-3", "ap-southeast-4", "ap-southeast-5", "ap-southeast-7", "ap-northeast-1", "ap-northeast-2", "ap-northeast-3", "ca-central-1", "ca-west-1", "eu-central-1", "eu-central-2", "eu-west-1", "eu-west-2", "eu-west-3", "eu-south-1", "eu-south-2", "eu-north-1", "il-central-1", "mx-central-1", "me-south-1", "me-central-1", "sa-east-1", "us-gov-east-1", "us-gov-west-1", "cn-north-1", "cn-northwest-1"]
      # DefaultTags: map
      test1.DefaultTags:
        fuzz:
          type: map
          minCount: 2
          maxCount: 4
      # CatalogRepositories: list
      test1.CatalogRepositories:
        fuzz:
          type: list
          minCount: 2
          maxCount: 4
      # RootTerragruntFileName: string
      test1.RootTerragruntFileName:
        fuzz:
          type: string
          minLength: 5
          maxLength: 20
      # AddAdditionalCommonVariables: bool
      test1.AddAdditionalCommonVariables:
        fuzz:
          type: bool
      # CatalogTags: string
      test1.CatalogTags:
        fuzz:
          type: string
          minLength: 5
          maxLength: 20
      # GithubOrgName: string, required
      test2.GithubOrgName:
        fuzz:
          type: string
          minLength: 5
          maxLength: 20
      # GithubRepoName: string, required
      test2.GithubRepoName:
        fuzz:
          type: string
          minLength: 5
          maxLength: 20
      # GithubOrgName: string
      test5.GithubOrgName:
        fuzz:
          type: string
          minLength: 5
          maxLength: 20
      # FirstName: string
      test5.FirstName:
        fuzz:
          type: string
          minLength: 5
          maxLength: 20
      # ProjectName: string, required
      test6-inputs.ProjectName:
        fuzz:
          type: string
          minLength: 5
          maxLength: 20
      # AuthorName: string
      test6-inputs.AuthorName:
        fuzz:
          type: string
          minLength: 5
          maxLength: 20

    steps:
      # Note: Order matters! Blocks that produce outputs must run before
      # blocks that consume them via {{ ._blocks.x.outputs.y }}
      # If no blocks are listed, the test runs all blocks in document order.

      # - block: test1
      #   # Template: templates/infra-live-elements
      #   expect: success

      # - block: template-test3-output-c0a27ff5
      #   # Renders: test3-output.yml
      #   # Uses inputs from: test2
      #   expect: success

      # - block: template-test4-output-9ec553cd
      #   # Renders: test4-output.yml
      #   expect: success

      # - block: test5
      #   # Template: templates/temp1
      #   expect: success

      # - block: test6-command
      #   expect: success

      # - block: template-test7-output-e3ce5b78
      #   # Renders: test7-output.txt
      #   # Uses inputs from: test6-inputs
      #   expect: success

    assertions:
      # TemplateInline blocks automatically validate their output dependencies.
      # Add additional assertions to validate test results:
      # - type: file_exists
      #   path: generated/README.md
      # - type: file_contains
      #   path: generated/README.md
      #   contains: "expected content"
      # - type: files_generated
      #   block: test1
      #   min_count: 1

    # cleanup:
    #   - command: rm -rf /tmp/test-resources
    #   - path: cleanup/teardown.sh
